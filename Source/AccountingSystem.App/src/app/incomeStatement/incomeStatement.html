<layout>
  <div class="row">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-body ">
          <div class="row">
            <div class="col-lg-4 col-md-12">
              <label>交易日起</label>
              <div class="form-group">
                <input name="tradingDayBegin" class="form-control" angular-mydatepicker
                  [(ngModel)]="conditionForView.tradingDayBegin" [options]="DatePickerUtility.DatePickerOptions"
                  #tradingDayBegin="angular-mydatepicker" (click)="tradingDayBegin.openCalendar()" />
              </div>
            </div>
            <div class="col-lg-4 col-md-12">
              <label>交易日迄</label>
              <div class="form-group">
                <input name="tradingDayEnd" class="form-control" angular-mydatepicker
                  [(ngModel)]="conditionForView.tradingDayEnd" [options]="DatePickerUtility.DatePickerOptions"
                  #tradingDayEnd="angular-mydatepicker" (click)="tradingDayEnd.openCalendar()" />
              </div>
            </div>
            <div class="col-lg-4 col-md-12">
              <label>統計間距</label>
              <div class="form-group">
                <input type="text" class="form-control" name="monthInterval" value=""
                  [(ngModel)]="conditionForView.monthInterval" />
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-6 col-md-12">
              <div class="form-group">
                <button (click)="filter()" type="submit" class="btn btn-default" style="width:100%">查詢</button>
              </div>
            </div>
            <div class="col-lg-6 col-md-12">
              <div class="form-group">
                <button (click)="clear()" type="reset" class="btn btn-default" style="width:100%">清空</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-body ">
          <div class="panel panel-default">
            <div class="panel-heading">
              <p></p>
            </div>
            <div class="panel-body">
              <div id="graph"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="row">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-body ">
          <div class="row font">
            <div class="col-md-12" style="text-align: center;font-weight: bold;">
              損益表
            </div>
          </div>
          <div class="row font">
            <div class="col-lg-2 col-md-12" style="max-width: 200px; flex: 0 0 200px;">
              <div>
                <table style="width:100%">
                  <thead>
                    <tr>
                      <th colspan="2">{{"&ensp;"}}</th>
                    </tr>
                    <tr>
                      <th width="50%">{{"&ensp;"}}</th>
                      <th width="50%">{{"&ensp;"}}</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="2">收入總計</td>
                    </tr>
                    <tr>
                      <td colspan="2">費用總計</td>
                    </tr>
                    <tr>
                      <td class="total" colspan="2">本期損益</td>
                    </tr>
                    <tr>
                      <td colspan="2">{{"&ensp;"}}</td>
                    </tr>
                    <tr>
                      <td colspan="2">營業收益</td>
                    </tr>
                    <tr *ngFor="let keyValuePair of operatingIncomes; let i=index;">
                      <td colspan="2">{{"&ensp;"}}{{"&ensp;"}}{{"&ensp;"}}{{"&ensp;"}}{{keyValuePair.key.name}}</td>
                    </tr>
                    <tr>
                      <td class="total" colspan="2">{{"&ensp;"}}{{"&ensp;"}}{{"&ensp;"}}{{"&ensp;"}}營業收益合計</td>
                    </tr>
                    <tr>
                      <td colspan="2">營業外收益</td>
                    </tr>
                    <tr *ngFor="let keyValuePair of nonOperatingIncomes; let i=index;">
                      <td colspan="2">{{"&ensp;"}}{{"&ensp;"}}{{"&ensp;"}}{{"&ensp;"}}{{keyValuePair.key.name}}</td>
                    </tr>
                    <tr>
                      <td class="total" colspan="2">{{"&ensp;"}}{{"&ensp;"}}{{"&ensp;"}}{{"&ensp;"}}營業外收益合計</td>
                    </tr>
                    <tr>
                      <td colspan="2">{{"&ensp;"}}</td>
                    </tr>
                    <tr>
                      <td colspan="2">營業成本</td>
                    </tr>
                    <tr *ngFor="let keyValuePair of operatingCosts; let i=index;">
                      <td colspan="2">{{"&ensp;"}}{{"&ensp;"}}{{"&ensp;"}}{{"&ensp;"}}{{keyValuePair.key.name}}</td>
                    </tr>
                    <tr>
                      <td colspan="2" style="height:35px">{{"&ensp;"}}{{"&ensp;"}}{{"&ensp;"}}{{"&ensp;"}}營業成本合計</td>
                    </tr>
                    <tr>
                      <td colspan="2">營業費用</td>
                    </tr>
                    <tr *ngFor="let keyValuePair of nonOperatingCosts; let i=index;">
                      <td colspan="2">{{"&ensp;"}}{{"&ensp;"}}{{"&ensp;"}}{{"&ensp;"}}{{keyValuePair.key.name}}</td>
                    </tr>
                    <tr>
                      <td colspan="2" class="total">{{"&ensp;"}}{{"&ensp;"}}{{"&ensp;"}}{{"&ensp;"}}營業費用合計</td>
                    </tr>
                    <tr>
                      <td>{{"&ensp;"}}</td>
                      <td>{{"&ensp;"}}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="col-lg-10 col-md-12" style="overflow: auto; white-space: nowrap; max-width: calc(100% - 200px); flex: 0 0 calc(100% - 200px);">
              <div style="display: inline-block; width: 200px" *ngFor="let key of keys; let i=index;">
                <table style="width:100%">
                  <thead>
                    <tr>
                      <th colspan="2">{{key}}</th>
                    </tr>
                    <tr>
                      <th width="50%">金額</th>
                      <th width="50%">百分比</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td class="numeric">{{total(key, AccountingSubjectType.Revenues).format('0,0')}}</td>
                      <td></td>
                    </tr>
                    <tr>
                      <td class="numeric">{{total(key, AccountingSubjectType.Expenses).format('0,0')}}</td>
                      <td></td>
                    </tr>
                    <tr>
                      <td class="numeric sum">{{netLossPeriod(key).format('0,0') }}</td>
                      <td>{{"&ensp;"}}</td>
                    </tr>
                    <tr>
                      <td>{{"&ensp;"}}</td>
                      <td>{{"&ensp;"}}</td>
                    </tr>
                    <tr>
                      <td>{{"&ensp;"}}</td>
                      <td>{{"&ensp;"}}</td>
                    </tr>
                    <tr *ngFor="let keyValuePair of operatingIncomes; let i=index;">
                      <td class="numeric">{{ get(key, keyValuePair).format('0,0') }}</td>
                      <td class="numeric">{{ proportion(get(key, keyValuePair), sum(key, operatingIncomes)) }}</td>
                    </tr>
                    <tr>
                      <td class="numeric sum">{{sum(key, operatingIncomes).format('0,0')}}</td>
                      <td></td>
                    </tr>
                    <tr>
                      <td>{{"&ensp;"}}</td>
                      <td>{{"&ensp;"}}</td>
                    </tr>
                    <tr *ngFor="let keyValuePair of nonOperatingIncomes; let i=index;">
                      <td class="numeric">{{ get(key, keyValuePair).format('0,0') }}</td>
                      <td class="numeric">{{ proportion(get(key, keyValuePair), sum(key, nonOperatingIncomes)) }}</td>
                    </tr>
                    <tr>
                      <td class="numeric sum">{{sum(key, nonOperatingIncomes).format('0,0')}}</td>
                      <td></td>
                    </tr>
                    <tr>
                      <td>{{"&ensp;"}}</td>
                      <td>{{"&ensp;"}}</td>
                    </tr>
                    <tr>
                      <td>{{"&ensp;"}}</td>
                      <td>{{"&ensp;"}}</td>
                    </tr>
                    <tr *ngFor="let keyValuePair of operatingCosts; let i=index;">
                      <td class="numeric">{{ get(key, keyValuePair).format('0,0') }}</td>
                      <td class="numeric">{{ proportion(get(key, keyValuePair), sum(key, operatingCosts)) }}</td>
                    </tr>
                    <tr>
                      <td class="numeric sum">{{sum(key, operatingCosts).format('0,0')}}</td>
                      <td></td>
                    </tr>
                    <tr>
                      <td>{{"&ensp;"}}</td>
                      <td>{{"&ensp;"}}</td>
                    </tr>
                    <tr *ngFor="let keyValuePair of nonOperatingCosts; let i=index;">
                      <td class="numeric">{{ get(key, keyValuePair).format('0,0') }}</td>
                      <td class="numeric">{{ proportion(get(key, keyValuePair), sum(key, nonOperatingCosts)) }}</td>
                    </tr>
                    <tr>
                      <td class="numeric sum">{{sum(key, nonOperatingCosts).format('0,0')}}</td>
                      <td></td>
                    </tr>
                    <tr>
                      <td>{{"&ensp;"}}</td>
                      <td>{{"&ensp;"}}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</layout>